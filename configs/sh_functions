## Load dev.sh (https://github.com/frdmn/dev-sh) search tool
. /usr/local/src/dev-search/dev
. /usr/local/src/dev-search/bash_completion.d/dev

## psshrun (https://github.com/frdmn/psshrun) autocompletion
. /usr/local/src/psshrun/bash_completion.d/psshrun

## dotfiles' Borkfile autocomplete
_dotfiles()
{
    case ${COMP_CWORD} in
    1)
        local configfiles
        cur=${COMP_WORDS[COMP_CWORD]}
        local configfiles="$(for x in `find ${HOME}/.dotfiles/borkfiles -type f -exec basename {} \;`; do echo ${x/.bork/}; done)"
        COMPREPLY=( $( compgen -W "${configfiles}" -- ${cur} ) )
        ;;
    *)
        COMPREPLY=()
        ;;
    esac
}
complete -F _dotfiles dotfiles

## Rename SSH tabs in tmux
ssh() {
    if [ "$(ps -p $(ps -p $$ -o ppid=) -o comm=)" = "tmux" ]; then
            emoji="ðŸ”‘"
            hostlabel=${*}                  # Pass hostname to $hostlabel
            hostlabel=${hostlabel%%.*}      # Remove possible TLD
            #hostlabel=${hostlabel##*@}     # Remove possible <user>@
            tmux rename-window "${emoji}  ${hostlabel}"
            command ssh "$@"
            tmux set-window-option automatic-rename "on" 1>/dev/null
    else
            command ssh "$@"
    fi
}
